import json
from shapely import wkt
import folium
from folium import plugins

# 道路数据
road_data = {
    "WKT": "LINESTRING (116.455207 39.980997,116.455362 39.981217,116.455883 39.981952,116.456392 39.982692,116.456596 39.982982,116.456645 39.983051,116.457095 39.983813,116.457331 39.984178,116.457208 39.98435,116.45716 39.985122,116.457143 39.985771,116.457101 39.986737,116.457095 39.986758,116.457058 39.98744,116.457052 39.987965,116.457074 39.988282,116.45717 39.988824,116.457186 39.988883,116.457251 39.989167,116.457294 39.989328,116.457337 39.989676,116.457342 39.990234,116.457342 39.990497,116.457315 39.991109,116.457315 39.991554,116.457374 39.992493,116.457396 39.992772,116.457422 39.992976,116.457519 39.994376,116.457519 39.994435,116.457546 39.99503,116.457562 39.995341,116.457615 39.996065,116.457648 39.9968,116.457637 39.996994,116.457637 39.997106,116.457648 39.997337,116.457675 39.998056,116.457707 39.998598,116.457782 39.999826,116.457846 40.000786,116.457852 40.000872,116.457868 40.001221,116.457868 40.00129,116.457889 40.001543,116.45797 40.003211,116.45797 40.003275,116.458023 40.00459,116.458039 40.004847,116.458136 40.006945,116.4582 40.007991,116.458195 40.008232)",
    "ADCODE": "110000",
    "ID": "137",
    "NAME": "望京西路",
    "DIRECTION": "由南向北",
    "FNAME": "望京桥",
    "TNAME": "望京西路北口",
    "LENGTH": "2985",
    "ROADCLASS": "44000"
}

def create_road_map():
    # 创建地图，中心点设置为道路的起点
    start_point = [39.980997, 116.455207]
    m = folium.Map(location=start_point, zoom_start=14)
    
    # 解析WKT数据
    line = wkt.loads(road_data["WKT"])
    coordinates = [(coord[1], coord[0]) for coord in line.coords]  # 注意经纬度顺序
    
    # 添加道路线
    folium.PolyLine(
        coordinates,
        weight=4,
        color='red',
        opacity=0.8,
        popup=f"{road_data['NAME']}<br>方向: {road_data['DIRECTION']}<br>长度: {road_data['LENGTH']}米"
    ).add_to(m)
    
    # 添加起点和终点标记
    folium.Marker(
        coordinates[0],
        popup=f"起点: {road_data['FNAME']}",
        icon=folium.Icon(color='green', icon='info-sign')
    ).add_to(m)
    
    folium.Marker(
        coordinates[-1],
        popup=f"终点: {road_data['TNAME']}",
        icon=folium.Icon(color='red', icon='info-sign')
    ).add_to(m)
    
    # 保存地图
    m.save('wangjing_road.html')

if __name__ == "__main__":
    create_road_map() 